<!doctype html>
<html lang="fr">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Travel Map Azgharie Airlines</title>
        <link href="https://unpkg.com/leaflet/dist/leaflet.css" rel="stylesheet"/>
        <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
        <style>
            body {
                font-family: Arial, sans-serif;
                margin: 0;
                padding: 0;
            }
            #header {
                position: fixed;
                top: 10px;
                left: 50%;
                transform: translateX(-50%);
                width: auto;
                max-width: calc(100% - 40px);
                min-width: 280px;
                height: 50px;
                background: #f4f4f4;
                padding: 0 10px;
                box-sizing: border-box; 
                box-shadow: 2px 0 5px rgba(0, 0, 0, 0.2);
                border-radius: 10px;
                overflow-y: auto;
                text-align: left;
                overflow: hidden;
                z-index: 25;
            }
            #map {
                z-index: 1;
            }
            .topnav {
                display: flex;
                background-color: #333;
                align-items: center;
                white-space: nowrap;
            }
            .topnav a {
              color: #f2f2f2;
              text-align: center;
              padding: 0 12px;
              text-decoration: none;
              font-size: 17px;
              display: inline-flex;
              align-items: center;
              height: 100%;
            }
            .topnav a img {
              display: block;
              height: 40px;
            }
            .topnav a:hover {
              background-color: #ddd;
              color: black;
            }
            .topnav a.active {
              background-color: #04AA6D;
              color: white;
            }

            #main_body {
                position: fixed;
                top: 70px;
                left: 50%;
                transform: translateX(-50%);
                width: 900px;
                height: 700px;
                background: #f4f4f4;
                padding: 0 10px;
                box-sizing: border-box; 
                box-shadow: 2px 0 5px rgba(0, 0, 0, 0.2);
                border-radius: 10px;
                z-index: 24;
            }
            
            #selectedAirframeDetails {
                margin-top: 20px;
                text-align: left;
                background: #f4f4f4;
            }
        </style>
    </head>

    <body>           
        <div id="main_body">
            <div style="text-align: center;">
                <a style="font-weight:bold"> choix de l'avion : </a>
                <select id="airframe" name="airframe"></select>
            </div>
            <div style=" top: 25px; left: 5px;">
                <a> <img src="airframe_dimsension.png" alt="airframe_dimsension.png" style="height: 150px">  </a>
            </div>
        </div>

        <div id="header" class="topnav">
            <script>const baseUrl = "https://luidj-78.github.io/Travelmap_AZH/";</script>
            <a href="https://www.azgharie.net/" target="_blank"> <img src="azgharie-removebg-preview.png" alt="azgharie-removebg-preview.png" style="height: 50px">  </a>
            <a href="#" onclick="window.location.href=baseUrl" style="color:#007BFF;font-weight:bold;">Acceuil</a>
            <a href="https://fshub.io/airline/AZH/radar" target="_blank" style="color:#007BFF;font-weight:bold;"> Radar </a>
            <a href="#" onclick="window.location.href=baseUrl + 'planificateur/'" style="color:#007BFF;font-weight:bold;">Planificateur de vol</a>
            <a href="#" onclick="window.location.href=baseUrl + 'passager/'" style="color:#007BFF;font-weight:bold;">Passager</a>
            <a href="#" onclick="window.location.href=baseUrl + 'cargo/'" style="color:#007BFF;font-weight:bold;">Cargo</a>
            <a href="#" onclick="window.location.href=baseUrl + 'airframe_spec/'" style="color:#007BFF;font-weight:bold;">BDD Avion</a>
        </div>

       <div id="map" style="position: absolute; top: 0px; left: 0; bottom: 0; right: 0;"></div>


        <script> //affichage de la map en fond
            var map = L.map('map', {zoomControl: false}).setView([48.8566, 2.3522], 4);
            L.tileLayer('https://{s}.tile.openstreetmap.fr/osmfr/{z}/{x}/{y}.png', { attribution: "&copy; OpenStreetMap contributeurs" }).addTo(map);
        </script>
        
        <script>
            const sheetURL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTjulAyJlAG5smNj1FHKrfqWijHp8asBRfrDAGhB94HF5udtGl3_dWC3bIkEyce6b-5jwsbFI20PFci/pub?gid=290961929&single=true&output=csv";
            fetch(sheetURL)
                .then((response) => response.text())
                .then((csvText) => {
                    const rows = csvText.split("\n");
                    const rows_length = rows.length;
                    const headers = rows[0].split(","); // Première ligne = légende
                    var table_airframe = {};
                    for (let y =  0; y < rows.length; y++) {
                        table_airframe[y] = rows[y].split(",").map(value => value.replace(/\r$/, '').trim());
                    }
                    //console.log(table_airframe);

                    const airframeSelect = document.getElementById('airframe');// Sélectionnez le menu déroulant
                    const selectedAirframeDetails = document.getElementById('selectedAirframeDetails');
                    const defaultOption = document.createElement('option'); // Ajoutez une option par défaut
                    defaultOption.value = "";
                    defaultOption.textContent = "Sélectionner un avion";
                    airframeSelect.appendChild(defaultOption);

                    var option = {};
                    for (let i = 1; i < rows_length; i++) { // Parcourez table_airframe et ajoutez les options
                        option[i] = document.createElement('option');
                        option[i].value = i; // La valeur est l'index de la ligne
                        option[i].textContent = table_airframe[i][2]; // Le texte est la 3ème colonne
                        airframeSelect.appendChild(option[i]);
                    }

                    // Écouteur d'événement pour le changement de sélection
                    airframeSelect.addEventListener('change', function() {
                        selectedIndex = this.value; // Index de la ligne
                        selectedText = this.options[this.selectedIndex].text; // Texte de l'option
                        console.log("Index de la ligne sélectionnée :", selectedIndex);
                        console.log("Nom de l'avion sélectionné :", selectedText);

                        const data_nomavion = table_airframe[selectedIndex][2]; //nom avion
                        const data_icao = table_airframe[selectedIndex][0]; //icao
                        const data_icaoweight = table_airframe[selectedIndex][16];
                        const data_azhcategorie = table_airframe[selectedIndex][4];
                        const data_type = table_airframe[selectedIndex][3];
                        const data_nbpax = table_airframe[selectedIndex][5];
                        const data_moteur = table_airframe[selectedIndex][6];
                        const data_nbmoteur = table_airframe[selectedIndex][7];
                        const data_longueur = table_airframe[selectedIndex][9];
                        const data_envergure = table_airframe[selectedIndex][10];
                        const data_oew = table_airframe[selectedIndex][12];
                        const data_mzfw = table_airframe[selectedIndex][13];
                        const data_mtow = table_airframe[selectedIndex][14];
                        const data_mlw = table_airframe[selectedIndex][15];
                        const data_maxfuel = table_airframe[selectedIndex][17];
                        const data_maxpayload = table_airframe[selectedIndex][18];
                        const data_vmax = table_airframe[selectedIndex][19];
                        const data_vcruise = table_airframe[selectedIndex][20];
                        const data_vapp = table_airframe[selectedIndex][21];
                        const data_plafond = table_airframe[selectedIndex][22];
                        const data_range = table_airframe[selectedIndex][23];
                        const data_takeoff = table_airframe[selectedIndex][24];
                        const data_landing = table_airframe[selectedIndex][25];
                        
                        let ligneRecommande = "";
                        let ligneAutorise = "";
                        let ligneInterdite = "";
                        var a = 0; 
                        var b = 0;
                        var c = 0;
                        for (let i = 27; i <= 39; i++) {
                            const value = table_airframe[selectedIndex][i];
                            const columnName = headers[i]; // Nom de la colonne (première ligne)
                            if (value === "1") {
                                if (a>0){ ligneRecommande += ", "};
                                ligneRecommande += columnName;
                                a+=1;
                            } else if (value === "2") {
                                if (b>0){ ligneAutorise += ", "};
                                ligneAutorise += columnName;
                                b+=1;
                            } else if (value === "0") {
                                if (c>0){ ligneInterdite += ", "};
                                ligneInterdite += columnName;
                                c+=1;
                            }
                        }
                        console.log(ligneRecommande);
                        console.log(ligneAutorise);
                        console.log(ligneInterdite);
                    });
                });
        </script>
    </body>
</html>
