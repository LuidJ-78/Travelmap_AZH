<!doctype html>
<html lang="fr">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Travel Map Azgharie Airlines</title>
        <link href="https://unpkg.com/leaflet/dist/leaflet.css" rel="stylesheet"/>
        <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
        <style>
            body {
                font-family: Arial, sans-serif;
                margin: 0;
                padding: 0;
            }
            
            #header {
                position: fixed;
                top: 10px;
                left: 50%;
                transform: translateX(-50%);
                width: auto;
                max-width: calc(100% - 40px);
                min-width: 280px;
                height: 50px;
                background: #f4f4f4;
                padding: 0 10px;
                box-sizing: border-box; 
                box-shadow: 2px 0 5px rgba(0, 0, 0, 0.2);
                border-radius: 10px;
                overflow: visible;
                text-align: left;
                z-index: 3;
            }
            .dropdown {
                position: relative;
                display: inline-block;
            }
            .dropdown-content {
                display: none;
                position: absolute;
                background-color: #f9f9f9;
                min-width: 155px;
                box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
                z-index: 3;
                left: 0;
                top: 100%;
                border-radius: 0px 0px 10px 10px;
                text-align: center;
            }
            .dropdown-content a {
                color: black;
                padding: 12px 16px;
                text-decoration: none;
                display: block;
            }
            .dropdown-content a:hover {
                background-color: #ddd;
            }
            .dropdown:hover .dropdown-content {
                display: block;
            }
            
            #map {
                z-index: 1;
            }
            .topnav {
                display: flex;
                background-color: #333;
                align-items: center;
                white-space: nowrap;
            }
            .topnav a {
              color: #f2f2f2;
              text-align: center;
              padding: 0 12px;
              text-decoration: none;
              font-size: 17px;
              display: inline-flex;
              align-items: center;
              height: 100%;
            }
            .topnav a img {
              display: block;
              height: 40px;
            }
            .topnav a:hover {
              background-color: #ddd;
              color: black;
            }
            .topnav a.active {
              background-color: #04AA6D;
              color: white;
            }

            #main_body {
                position: fixed;
                top: 70px;
                left: 50%;
                transform: translateX(-50%);
                width: 900px;
                height: 700px;
                background: #f4f4f4;
                padding: 0 10px;
                box-sizing: border-box; 
                box-shadow: 2px 0 5px rgba(0, 0, 0, 0.2);
                border-radius: 10px;
                z-index: 2;
            }
            .data_tooltip { 
                position: relative; 
                display: inline-block; 
                cursor: help; 
            } 
            .data_tooltip .data_tooltiptext { 
                visibility: hidden; 
                width: 250px; 
                background: rgba(0,0,0,0.85); 
                color: #fff; 
                text-align: center; 
                padding: 8px; 
                border-radius: 6px; 
                position: absolute; 
                z-index: 3; 
                bottom: 130%; 
                left: 50%; 
                transform: translateX(-50%); 
                opacity: 0; 
                transition: opacity .18s ease; 
                box-shadow: 0 2px 6px rgba(0,0,0,0.3); 
                pointer-events: none; 
            } 
            .data_tooltip:hover .data_tooltiptext, .data_tooltip:focus-within .data_tooltiptext { 
                visibility: visible; 
                opacity: 1; 
                pointer-events: auto; 
            }
            
            #selectedAirframeDetails {
                margin-top: 20px;
                text-align: left;
                background: #f4f4f4;
            }
        </style>
    </head>
    
    <body>
        <div id="header" class="topnav">
            <script>const baseUrl = "https://luidj-78.github.io/Travelmap_AZH/";</script>
            <a href="https://www.azgharie.net/" target="_blank"> <img src="azgharie-removebg-preview.png" alt="azgharie-removebg-preview.png" style="height: 50px">  </a>
            <a href="#" onclick="window.location.href=baseUrl" style="color:#007BFF;font-weight:bold;">Acceuil</a>
            <a href="https://fshub.io/airline/AZH/radar" target="_blank" style="color:#007BFF;font-weight:bold;"> Radar </a>
            <a href="#" onclick="window.location.href=baseUrl + 'planificateur/'" style="color:#007BFF;font-weight:bold;">Planificateur de vol</a>
            <div class="dropdown" style="display: inline-block; height: 100%;">
                <a href="#" style="color:#007BFF;font-weight:bold;height: 100%;display: flex;align-items: center;padding: 0 12px;">Carte de voyage</a>
                <div class="dropdown-content">
                    <a href="#" onclick="window.location.href=baseUrl + 'passager/'" style="color:#007BFF;font-weight:bold;">Passager </a> <br />
                    <a href="#" onclick="window.location.href=baseUrl + 'cargo/'" style="color:#007BFF;font-weight:bold;">Cargo</a>
                </div>
            </div>
            <div class="dropdown" style="display: inline-block; height: 100%;">
                <a href="#" style="color:#007BFF;font-weight:bold;height: 100%;display: flex;align-items: center;padding: 0 12px;">Base de donnée</a>
                <div class="dropdown-content">
                    <a href="#" onclick="window.location.href=baseUrl + 'database/avion/'" style="color:#007BFF;font-weight:bold;">Avion </a> <!--<br />
                    <a href="#" onclick="window.location.href=baseUrl + 'database/aeroport/'" style="color:#007BFF;font-weight:bold;">Aéroport</a>-->
                </div>
            </div>
        </div>
        
        <div id="main_body">
            <div style="text-align: left; position: fixed; top: 30px; left: 100px">
                <a style="font-weight:bold;"> choix de l'avion : </a>
                <select id="airframe" name="airframe"></select>
            </div>
            <div style="position: fixed; top: 70px; left: 50px; width: 550px;">
                <a style="font-weight:bold;">Caractérisation</a>
                <div><a> code ICAO : </a><span id="data_icao"> </span></div>
                <div><a> type : </a><span id="data_type"> </span></div>
                <div><a> nombre de passager : </a><span id="data_nbpax"> </span></div>
                <div><a> catégorie : </a><span id="data_azhcategorie"> </span></div>
                <div><a> ligne Recommande : </a><span id="data_ligneRecommande"> </span></div>
                <div><a> ligne Autorise : </a><span id="data_ligneAutorise"> </span></div>
                <div><span class="data_tooltip" tabindex="0" aria-describedby="ligneInterdite-data_tooltip"> ligne Interdite : <span id="ligneInterdite-data_tooltip" class="data_tooltiptext" role="data_tooltip">Ou à vos risques et périls </span></span><span id="data_ligneInterdite"> </span></div>
            </div>
            <div style="position: fixed; top: 70px; right: 70px;">
                <h4>Dimension de l'avion</h4>
                <a> <img src="airframe_dimsension.png" alt="airframe_dimsension.png" style="height: 200px">  </a>
                <span id="data_longueur" style="position: fixed; top: 125px; left: 630px;"> </span>
                <span id="data_envergure" style="position: fixed; top: 280px; right: 30px;"> </span>
            </div>
            <div style="position: fixed; top: 250px; left: 50px; width: 300px;">
                <a style="font-weight:bold;">Moteur</a>
                <div><a> type : </a><span id="data_moteur"> </span></div>
                <div><a> nombre : </a><span id="data_nbmoteur"> </span></div>
            </div>
            <div style="position: fixed; top: 325px; left: 50px; width: 300px;">
                <a style="font-weight:bold;">Masse</a>
                <div><a> catégorie : </a><span id="data_icaoweight"> </span></div>
                <div><span class="data_tooltip" tabindex="0" aria-describedby="OEW-data_tooltip"> OEW : <span id="OEW-data_tooltip" class="data_tooltiptext" role="data_tooltip">Masse à vide en opération</span></span><span id="data_oew"> </span></div>
                <div><span class="data_tooltip" tabindex="0" aria-describedby="MZFW-data_tooltip"> MZFW : <span id="MZFW-data_tooltip" class="data_tooltiptext" role="data_tooltip">Masse max sans carburant</span></span><span id="data_mzfw"> </span></div>
                <div><span class="data_tooltip" tabindex="0" aria-describedby="MTOW-data_tooltip"> MTOW : <span id="MZFW-data_tooltip" class="data_tooltiptext" role="data_tooltip">Masse max au décollage</span></span><span id="data_mtow"> </span></div>
                <div><span class="data_tooltip" tabindex="0" aria-describedby="MLW-data_tooltip"> MLW : <span id="MZFW-data_tooltip" class="data_tooltiptext" role="data_tooltip">Masse max à l'atterrissage</span></span><span id="data_mlw"> </span></div>
                <div><a> Masse carburant max : </a><span id="data_maxfuel"> </span></div>
                <div><a> Masse charge utile max : </a><span id="data_maxpayload"> </span></div>
            </div>
            <div style="position: fixed; top: 485px; left: 50px; width: 300px;">
                <a style="font-weight:bold;">Performance</a>
                <div><a> Vitesse max : </a><span id="data_vmax"> </span></div>
                <div><a> Vitesse de croisière : </a><span id="data_vcruise"> </span></div>
                <div><a> Vitesse d'approche : </a><span id="data_vapp"> </span></div>
                <div><a> Plafond : </a><span id="data_plafond"> </span></div>
                <div><span class="data_tooltip" tabindex="0" aria-describedby="OEW-data_tooltip"> Autonomie max :  <span id="range-data_tooltip" class="data_tooltiptext" role="data_tooltip">charge utile 0 kg, carburant 100 % </span></span><span id="data_range"> </span></div>
                <div><span class="data_tooltip" tabindex="0" aria-describedby="OEW-data_tooltip"> distance de décollage :  <span id="takeoff-data_tooltip" class="data_tooltiptext" role="data_tooltip">MTOW, niveau de la mer, 15°C </span></span><span id="data_takeoff"> </span></div>
                <div><span class="data_tooltip" tabindex="0" aria-describedby="OEW-data_tooltip"> distance d'atterrissage :  <span id="landing-data_tooltip" class="data_tooltiptext" role="data_tooltip">MLW, niveau de la mer, 15°C </span></span><span id="data_landing"> </span></div>
            </div>
            <div style="position: fixed; font-size: 80%; top: 500px; right: 70px; width: 200px;">
                <p> 
                    Les données ont été récupéré sur divers sources comme wikipédia, aircraftinvestigation.info ou globalair.com, mais aussi grace à l'IA. <br />
                    Il peut y avoir des variations en fonction de la version, des options ou de l'année de l'avion.
                </p>
            </div>
        </div>

       <div id="map" style="position: absolute; top: 0px; left: 0; bottom: 0; right: 0;"></div>

        <script> //affichage de la map en fond
            var map = L.map('map', {zoomControl: false}).setView([48.8566, 2.3522], 4);
            L.tileLayer('https://{s}.tile.openstreetmap.fr/osmfr/{z}/{x}/{y}.png', { attribution: "&copy; OpenStreetMap contributeurs" }).addTo(map);
        </script>
        
        <script>
            const sheetURL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTjulAyJlAG5smNj1FHKrfqWijHp8asBRfrDAGhB94HF5udtGl3_dWC3bIkEyce6b-5jwsbFI20PFci/pub?gid=290961929&single=true&output=csv";
            fetch(sheetURL)
                .then((response) => response.text())
                .then((csvText) => {
                    const rows = csvText.split("\n");
                    const rows_length = rows.length;
                    const headers = rows[0].split(","); // Première ligne = légende
                    var table_airframe = {};
                    for (let y =  0; y < rows.length; y++) {
                        table_airframe[y] = rows[y].split(",").map(value => value.replace(/\r$/, '').trim());
                    }
                    //console.log(table_airframe);

                    const airframeSelect = document.getElementById('airframe');// Sélectionnez le menu déroulant
                    const selectedAirframeDetails = document.getElementById('selectedAirframeDetails');
                    const defaultOption = document.createElement('option'); // Ajoutez une option par défaut
                    defaultOption.value = "";
                    defaultOption.textContent = "Sélectionner un avion";
                    airframeSelect.appendChild(defaultOption);

                    var option = {};
                    for (let i = 1; i < rows_length; i++) { // Parcourez table_airframe et ajoutez les options
                        option[i] = document.createElement('option');
                        option[i].value = i; // La valeur est l'index de la ligne
                        option[i].textContent = table_airframe[i][2]; // Le texte est la 3ème colonne
                        airframeSelect.appendChild(option[i]);
                    }

                    // Écouteur d'événement pour le changement de sélection
                    airframeSelect.addEventListener('change', function() {
                        selectedIndex = this.value; // Index de la ligne
                        selectedText = this.options[this.selectedIndex].text; // Texte de l'option
                        console.log("Index de la ligne sélectionnée :", selectedIndex);
                        console.log("Nom de l'avion sélectionné :", selectedText);

                        //document.getElementById("data_nomavion").textContent = table_airframe[selectedIndex][2];
                        document.getElementById("data_icao").textContent = table_airframe[selectedIndex][0];
                        document.getElementById("data_icaoweight").textContent = table_airframe[selectedIndex][16];
                        document.getElementById("data_azhcategorie").textContent = table_airframe[selectedIndex][4];
                        document.getElementById("data_type").textContent = table_airframe[selectedIndex][3];
                        document.getElementById("data_nbpax").textContent = table_airframe[selectedIndex][5];
                        document.getElementById("data_moteur").textContent = table_airframe[selectedIndex][6];
                        document.getElementById("data_nbmoteur").textContent = table_airframe[selectedIndex][7];
                        document.getElementById("data_longueur").textContent = table_airframe[selectedIndex][9] + " m";
                        document.getElementById("data_envergure").textContent = table_airframe[selectedIndex][10] + " m";
                        document.getElementById("data_oew").textContent = " " + table_airframe[selectedIndex][12] + " kg";
                        document.getElementById("data_mzfw").textContent = " " + table_airframe[selectedIndex][13] + " kg";
                        document.getElementById("data_mtow").textContent = " " + table_airframe[selectedIndex][14] + " kg";
                        document.getElementById("data_mlw").textContent = " " + table_airframe[selectedIndex][15] + " kg";
                        document.getElementById("data_maxfuel").textContent = table_airframe[selectedIndex][17] + " kg";
                        document.getElementById("data_maxpayload").textContent = table_airframe[selectedIndex][18] + " kg";
                        document.getElementById("data_vmax").textContent = table_airframe[selectedIndex][19] + " kts";
                        document.getElementById("data_vcruise").textContent = table_airframe[selectedIndex][20] + " kts";
                        document.getElementById("data_vapp").textContent = table_airframe[selectedIndex][21] + " kts";
                        document.getElementById("data_plafond").textContent = table_airframe[selectedIndex][22] + " ft";
                        document.getElementById("data_range").textContent = " " + table_airframe[selectedIndex][23] + " nm";
                        document.getElementById("data_takeoff").textContent = " " + table_airframe[selectedIndex][24] + " ft";
                        document.getElementById("data_landing").textContent = " " + table_airframe[selectedIndex][25] + " ft";
                        
                        let ligneRecommande = "";
                        let ligneAutorise = "";
                        let ligneInterdite = "";
                        var a = 0; 
                        var b = 0;
                        var c = 0;
                        for (let i = 27; i <= 39; i++) {
                            const value = table_airframe[selectedIndex][i];
                            const columnName = headers[i]; // Nom de la colonne (première ligne)
                            if (value === "1") {
                                if (a>0){ ligneRecommande += ", "};
                                ligneRecommande += columnName;
                                a+=1;
                            } else if (value === "2") {
                                if (b>0){ ligneAutorise += ", "};
                                ligneAutorise += columnName;
                                b+=1;
                            } else if (value === "0") {
                                if (c>0){ ligneInterdite += ", "};
                                ligneInterdite += columnName;
                                c+=1;
                            }
                        }
                        console.log(ligneRecommande);
                        console.log(ligneAutorise);
                        console.log(ligneInterdite);
                        document.getElementById("data_ligneRecommande").textContent = ligneRecommande;
                        document.getElementById("data_ligneAutorise").textContent = ligneAutorise;
                        document.getElementById("data_ligneInterdite").textContent = " " + ligneInterdite;
                    });
                });
        </script>
    </body>
</html>
